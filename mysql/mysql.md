# Mysql索引优化

## 一、 存在问题

**性能下降SQL慢 执行时间长 等待时间长**

数据太多→分库分表

关联了太多的表，太多join→SQL优化

没有充分利用到索引→索引建立

服务器调优及各个参数配置→调整**my.inf**

小结：索引优化很重要 

## 二、索引简介

### 1.原理

一句话；**排好序的快速查找的数据结构**

Mysql底层使用的是**B+树**

**TODO:这里哪天搞明白了再把笔记补上**

### 2. 作用

检索：降低IO

排序：降低CPU运算消耗

索引的作用就是加快检索和排序

**索引的缺点：**

1. 虽然索引大大提高了查询速度，同时却会**降低更新表的速度**，如对表进行INSERT、UPDATE和DELETE。
   因为更新表时，MySQL不仅要保存数据，还要保存一下索引文件每次更新添加了索引列的字段，
   都会调整因为更新所带来的键值变化后的索引信息
2. 实际上索引也是一张表，该表保存了主键与索引字段，并指向实体表的记录，所以索引列也是要**占用空间**的

### 3.索引的分类

* 单值索引
  * 即一个索引只包含单个列，一个表可以有多个单列索引
* 唯一索引
  * 索引列的值必须唯一，但允许有空值
* 主键索引
  * 设定为主键后数据库会自动建立索引，innodb为聚簇索引
* 复合索引
  * 即一个索引包含多个列
* 全文索引：一般不用，全文的检索一般用Solr等搜索引擎替代

创建、删除、查看索引的语法略

#### 4.哪些情况需要建索引

* 主键自动建立唯一索引
* 频繁作为查询条件的字段应该创建索引
* 查询中与其它表关联的字段，外键关系建立索引
* 单键/组合索引的选择问题， 组合索引性价比更高
* 查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度
* 查询中统计或者分组字段

​	记：单表索引最好不超过五个，优先复合索引

### 5. 哪些情况不需要建索引

* 表记录太少
* 经常增删改的表或者字段
* Where条件里用不到的字段不创建索引
* 过滤性不好的不适合建索引

### 三、索引性能分析：Explain